<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•æ£®å…¨èƒ½æ”»ç•¥ V3.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- 1. è¨­è¨ˆç³»çµ± --- */
        :root {
            --bg-cream: #F8F5E8;
            --nook-green: #8DD2BA;
            --nook-dark: #58B09C;
            --text-main: #58534A;
            --card-white: #FFFFFF;
            --tab-active: #F4A261;
            --shadow: 4px 4px 0px rgba(0,0,0,0.1);
            --radius: 20px;
        }

        body {
            background-color: var(--bg-cream);
            color: var(--text-main);
            font-family: 'Varela Round', "Microsoft JhengHei", sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- 2. é ‚éƒ¨å°èˆª --- */
        header {
            background: var(--nook-green);
            width: 100%;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 { margin: 0; color: white; font-size: 1.5rem; letter-spacing: 2px; }

        .progress-container {
            width: 80%;
            max-width: 600px;
            background: rgba(255,255,255,0.3);
            border-radius: 20px;
            margin: 15px auto 0;
            overflow: hidden;
            height: 10px;
        }

        .progress-bar {
            height: 100%;
            background: #FFD54F;
            width: 0%;
            transition: width 0.5s ease;
        }

        .stats-text { color: white; font-size: 0.9rem; margin-top: 5px; }

        /* --- 3. å·¥å…·åˆ— --- */
        .toolbar {
            width: 95%;
            max-width: 1000px;
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        /* æœå°‹èˆ‡ç¯©é¸ */
        .search-row {
            display: flex;
            width: 100%;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            position: relative;
            min-width: 200px;
            max-width: 400px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 20px;
            border-radius: 30px;
            border: 2px solid var(--nook-green);
            outline: none;
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
        }

        .btn-toggle {
            padding: 8px 16px;
            border-radius: 20px;
            border: 2px solid var(--nook-green);
            background: white;
            cursor: pointer;
            font-weight: bold;
            color: var(--nook-dark);
            transition: 0.2s;
            white-space: nowrap;
        }

        .btn-toggle.active { background: var(--nook-green); color: white; }

        /* --- 4. å¯æ»‘å‹•çš„åˆ†é ç±¤ (Tabs) --- */
        .tabs-container {
            width: 100%;
            overflow-x: auto;
            white-space: nowrap;
            padding-bottom: 5px; /* éš±è—æ²è»¸é€ æˆçš„è²¼åº• */
            text-align: center;
        }

        /* éš±è—æ²è»¸æ¨£å¼ */
        .tabs-container::-webkit-scrollbar { display: none; }

        .tab-btn {
            display: inline-block;
            padding: 10px 20px;
            background: #E0E0E0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            color: #777;
            margin: 0 5px;
            transition: 0.3s;
        }

        .tab-btn.active {
            background: var(--tab-active);
            color: white;
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        /* --- 5. ç¶²æ ¼èˆ‡å¡ç‰‡ --- */
        #grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            width: 95%;
            max-width: 1200px;
            padding-bottom: 40px;
        }

        .card {
            background: var(--card-white);
            border-radius: var(--radius);
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            position: relative;
            cursor: pointer;
            transition: 0.2s;
        }

        .card:hover { transform: translateY(-3px); border-color: var(--nook-green); }

        .card.caught { background: #E8F5E9; opacity: 0.7; border: 2px solid #81C784; }
        .card.caught::after {
            content: "âœ”";
            position: absolute;
            top: 10px; right: 10px;
            background: #4CAF50; color: white;
            width: 25px; height: 25px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem;
        }

        .card-icon {
            width: 50px; height: 50px;
            background: #F0F4C3;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 25px;
            flex-shrink: 0;
        }

        .card-info { flex: 1; }
        .card-info h3 { margin: 0 0 5px 0; font-size: 1.1rem; }
        
        .meta-tags { font-size: 0.85rem; color: #666; margin-top: 5px; line-height: 1.4; }
        
        .time-badge {
            display: inline-block;
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 10px;
            margin-top: 5px;
        }
        .bg-active { background: #C8E6C9; color: #2E7D32; }
        .bg-inactive { background: #FFCDD2; color: #C62828; }
        .price-tag { color: #F57F17; font-weight: bold; }
        
    </style>
</head>
<body>

    <header>
        <h1>ğŸï¸ å‹•æ£®å…¨èƒ½æ”»ç•¥</h1>
        <div class="stats-text" id="stats-display">è¼‰å…¥ä¸­...</div>
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </header>

    <div class="toolbar">
        <div class="tabs-container">
            <button class="tab-btn active" onclick="switchTab('fish')">ğŸŸ é­šé¡</button>
            <button class="tab-btn" onclick="switchTab('bug')">ğŸ¦‹ æ˜†èŸ²</button>
            <button class="tab-btn" onclick="switchTab('sea')">ğŸ¤¿ æµ·æ´‹ç”Ÿç‰©</button>
            <button class="tab-btn" onclick="switchTab('fossil')">ğŸ¦• åŒ–çŸ³</button>
            <button class="tab-btn" onclick="switchTab('material')">ğŸ¥¥ ç´ æ</button>
            <button class="tab-btn" onclick="switchTab('furniture')">ğŸª‘ å®¶å…·</button>
        </div>

        <div class="search-row">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="è¼¸å…¥åç¨±æœå°‹..." oninput="handleSearch()">
                <i class="fas fa-search"></i>
            </div>
            <button class="btn-toggle" id="btn-now" onclick="toggleNow()">â° åªçœ‹ç¾åœ¨</button>
            <button class="btn-toggle" id="btn-uncaught" onclick="toggleUncaught()">â¬œ åªçœ‹æœªæŠ“</button>
        </div>
    </div>

    <div id="grid-container">
        </div>

    <script>
// --- 1. è³‡æ–™åº« (V3.1 è©¦ç®—è¡¨æ›´æ–°ç‰ˆ) ---
        
        // ğŸŸ é­šé¡ (80éš»å®Œæ•´ç‰ˆ)
        const fishData = [
            { id: "f1", name: "ç´…ç›®é¯½", price: 900, loc: "æ²³å·", shadow: "ç‰¹å°", months: [1,2,3,11,12], time: [[0, 24]] },
            { id: "f2", name: "æºªå“¥", price: 200, loc: "æ²³å·", shadow: "ç‰¹å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[9, 16]] },
            { id: "f3", name: "é¯½é­š", price: 160, loc: "æ²³å·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f4", name: "ç æ˜Ÿä¸‰å¡Šé­š", price: 240, loc: "æ²³å·", shadow: "ä¸­åå°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[16, 9]] },
            { id: "f5", name: "é¯‰é­š", price: 300, loc: "æ± å¡˜", shadow: "ä¸­åå¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f6", name: "éŒ¦é¯‰", price: 4000, loc: "æ± å¡˜", shadow: "ä¸­åå¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[16, 9]] },
            { id: "f7", name: "é‡‘é­š", price: 1300, loc: "æ± å¡˜", shadow: "ç‰¹å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f8", name: "é¾ç›é‡‘é­š", price: 1300, loc: "æ± å¡˜", shadow: "ç‰¹å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[9, 16]] },
            { id: "f9", name: "è˜­å£½é‡‘é­š", price: 4500, loc: "æ± å¡˜", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[9, 16]] },
            { id: "f10", name: "ç¨»ç”°é­š", price: 300, loc: "æ± å¡˜", shadow: "ç‰¹å°", months: [4,5,6,7,8], time: [[0, 24]] },
            { id: "f11", name: "æ·¡æ°´é¾è¦", price: 200, loc: "æ± å¡˜", shadow: "å°", months: [4,5,6,7,8,9], time: [[0, 24]] },
            { id: "f12", name: "é±‰", price: 3750, loc: "æ²³å·", shadow: "ä¸­åå¤§", months: [8,9], time: [[16, 9]] },
            { id: "f13", name: "æ“¬é±·é¾œ", price: 5000, loc: "æ²³å·", shadow: "ä¸­åå¤§", months: [4,5,6,7,8,9,10], time: [[21, 4]] },
            { id: "f14", name: "èŒèšª", price: 100, loc: "æ± å¡˜", shadow: "ç‰¹å°", months: [3,4,5,6,7], time: [[0, 24]] },
            { id: "f15", name: "é’è›™", price: 120, loc: "æ± å¡˜", shadow: "å°", months: [5,6,7,8], time: [[0, 24]] },
            { id: "f16", name: "å¡˜é±§é­š", price: 400, loc: "æ²³å·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[16, 9]] },
            { id: "f17", name: "æ³¥é°", price: 400, loc: "æ²³å·", shadow: "å°", months: [3,4,5], time: [[0, 24]] },
            { id: "f18", name: "é¯°é­š", price: 800, loc: "æ± å¡˜", shadow: "ä¸­åå¤§", months: [5,6,7,8,9,10], time: [[16, 9]] },
            { id: "f19", name: "é±§é­š", price: 5500, loc: "æ± å¡˜", shadow: "ä¸­åå¤§", months: [6,7,8], time: [[9, 16]] },
            { id: "f20", name: "è—é°“å¤ªé™½é­š", price: 180, loc: "æ²³å·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[9, 16]] },
            { id: "f21", name: "é»ƒé±¸é­š", price: 300, loc: "æ²³å·", shadow: "ä¸­åå°", months: [1,2,3,10,11,12], time: [[0, 24]] },
            { id: "f22", name: "é»‘é±¸é­š", price: 400, loc: "æ²³å·", shadow: "ä¸­åå¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f23", name: "å³éƒ­é­š", price: 800, loc: "æ²³å·", shadow: "ä¸­åå°", months: [6,7,8,9,10], time: [[0, 24]] },
            { id: "f24", name: "ç™½æ–‘ç‹—é­š", price: 1800, loc: "æ²³å·", shadow: "å¤§", months: [9,10,11,12], time: [[0, 24]] },
            { id: "f25", name: "è¥¿å¤ªå…¬é­š", price: 500, loc: "æ²³å·", shadow: "å°", months: [1,2,12], time: [[0, 24]] },
            { id: "f26", name: "é¦™é­š", price: 900, loc: "æ²³å·", shadow: "ä¸­åå°", months: [7,8,9], time: [[0, 24]] },
            { id: "f27", name: "æ«»èŠ±é‰¤å»é®­", price: 1000, loc: "æ‡¸å´–ä¸Š", shadow: "ä¸­åå°", months: [3,4,5,6,9,10,11], time: [[16, 9]] },
            { id: "f28", name: "èŠ±ç¾”ç´…é»é®­", price: 3800, loc: "æ‡¸å´–ä¸Š", shadow: "ä¸­åå°", months: [3,4,5,6,9,10,11], time: [[16, 9]] },
            { id: "f29", name: "é‡‘é±’", price: 15000, loc: "æ‡¸å´–ä¸Š", shadow: "ä¸­åå°", months: [3,4,5,9,10,11], time: [[16, 9]] },
            { id: "f30", name: "é æ±å“²ç¾…é­š", price: 15000, loc: "æ‡¸å´–ä¸Š", shadow: "å¤§", months: [1,2,3,12], time: [[16, 9]] },
            { id: "f31", name: "é®­é­š", price: 700, loc: "å‡ºæµ·å£", shadow: "ä¸­åå¤§", months: [9], time: [[0, 24]] },
            { id: "f32", name: "å¸ç‹é®­", price: 1800, loc: "å‡ºæµ·å£", shadow: "å¤§", months: [9], time: [[0, 24]] },
            { id: "f33", name: "ä¸­è¯çµ¨è¯èŸ¹", price: 2000, loc: "æ²³å·", shadow: "å°", months: [9,10,11], time: [[16, 9]] },
            { id: "f34", name: "å­”é›€é­š", price: 1300, loc: "æ²³å·", shadow: "ç‰¹å°", months: [4,5,6,7,8,9,10,11], time: [[9, 16]] },
            { id: "f35", name: "æº«æ³‰é†«ç”Ÿé­š", price: 1500, loc: "æ²³å·", shadow: "ç‰¹å°", months: [5,6,7,8,9], time: [[9, 16]] },
            { id: "f36", name: "ç¥ä»™é­š", price: 3000, loc: "æ²³å·", shadow: "å°", months: [5,6,7,8,9,10], time: [[16, 9]] },
            { id: "f37", name: "é¬¥é­š", price: 2500, loc: "æ²³å·", shadow: "å°", months: [5,6,7,8,9,10], time: [[9, 16]] },
            { id: "f38", name: "éœ“è™¹ç‡ˆé­š", price: 500, loc: "æ²³å·", shadow: "ç‰¹å°", months: [4,5,6,7,8,9,10,11], time: [[9, 16]] },
            { id: "f39", name: "å½©è™¹é­š", price: 800, loc: "æ²³å·", shadow: "å°", months: [5,6,7,8,9,10], time: [[9, 16]] },
            { id: "f40", name: "é£Ÿäººé­š", price: 2500, loc: "æ²³å·", shadow: "å°", months: [6,7,8,9], time: [[9, 16], [21, 4]] },
            { id: "f41", name: "éª¨èˆŒé­š", price: 10000, loc: "æ²³å·", shadow: "ä¸­åå¤§", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f42", name: "é»ƒé‡‘æ²³è™", price: 15000, loc: "æ²³å·", shadow: "å¤§", months: [6,7,8,9], time: [[4, 21]] },
            { id: "f43", name: "é›€é±”", price: 6000, loc: "æ± å¡˜", shadow: "å¤§", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f44", name: "å·¨éª¨èˆŒé­š", price: 10000, loc: "æ²³å·", shadow: "ç‰¹å¤§", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f45", name: "æ©æ°å¤šé°­é­š", price: 4000, loc: "æ²³å·", shadow: "ä¸­åå¤§", months: [6,7,8,9], time: [[21, 4]] },
            { id: "f46", name: "é±˜é­š", price: 10000, loc: "å‡ºæµ·å£", shadow: "ç‰¹å¤§", months: [1,2,3,9,10,11,12], time: [[0, 24]] },
            { id: "f47", name: "æµ·å¤©ä½¿", price: 1000, loc: "å¤§æµ·", shadow: "ç‰¹å°", months: [1,2,3,12], time: [[0, 24]] },
            { id: "f48", name: "æµ·é¦¬", price: 1100, loc: "å¤§æµ·", shadow: "ç‰¹å°", months: [4,5,6,7,8,9,10,11], time: [[0, 24]] },
            { id: "f49", name: "å°ä¸‘é­š", price: 650, loc: "å¤§æµ·", shadow: "ç‰¹å°", months: [4,5,6,7,8,9], time: [[0, 24]] },
            { id: "f50", name: "æ“¬åˆºå°¾é¯›", price: 1000, loc: "å¤§æµ·", shadow: "å°", months: [4,5,6,7,8,9], time: [[0, 24]] },
            { id: "f51", name: "è€³å¸¶è´è¶é­š", price: 1000, loc: "å¤§æµ·", shadow: "å°", months: [4,5,6,7,8,9], time: [[0, 24]] },
            { id: "f52", name: "è˜‡çœ‰é­š", price: 10000, loc: "å¤§æµ·", shadow: "ç‰¹å¤§", months: [7,8], time: [[4, 21]] },
            { id: "f53", name: "ç…å­é­š", price: 500, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [4,5,6,7,8,9,10,11], time: [[0, 24]] },
            { id: "f54", name: "æ²³è±š", price: 5000, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [1,2,11,12], time: [[21, 4]] },
            { id: "f55", name: "åˆºæ²³è±š", price: 250, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [7,8,9], time: [[0, 24]] },
            { id: "f56", name: "é³³å°¾é­š", price: 200, loc: "å¤§æµ·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[4, 21]] },
            { id: "f57", name: "ç«¹ç­´é­š", price: 150, loc: "å¤§æµ·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f58", name: "æ¢çŸ³é¯›", price: 5000, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [3,4,5,6,7,8,9,10,11], time: [[0, 24]] },
            { id: "f59", name: "é±¸é­š", price: 400, loc: "å¤§æµ·", shadow: "å¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f60", name: "é¯›é­š", price: 3000, loc: "å¤§æµ·", shadow: "ä¸­åå¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f61", name: "é°ˆé­š", price: 300, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [1,2,3,4,10,11,12], time: [[0, 24]] },
            { id: "f62", name: "æ¯”ç›®é­š", price: 800, loc: "å¤§æµ·", shadow: "å¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "f63", name: "é­·é­š", price: 500, loc: "å¤§æµ·", shadow: "ä¸­åå°", months: [1,2,3,4,5,6,7,8,12], time: [[0, 24]] },
            { id: "f64", name: "è£¸èƒ¸é±”", price: 2000, loc: "å¤§æµ·", shadow: "ç´°é•·", months: [8,9,10], time: [[0, 24]] },
            { id: "f65", name: "äº”å½©é°»", price: 600, loc: "å¤§æµ·", shadow: "ç´°é•·", months: [6,7,8,9,10], time: [[0, 24]] },
            { id: "f66", name: "é®ªé­š", price: 7000, loc: "ç¢¼é ­", shadow: "ç‰¹å¤§", months: [1,2,3,4,11,12], time: [[0, 24]] },
            { id: "f67", name: "æ——é­š", price: 10000, loc: "ç¢¼é ­", shadow: "ç‰¹å¤§", months: [1,2,3,4,7,8,9,11,12], time: [[0, 24]] },
            { id: "f68", name: "æµªäººé°º", price: 4500, loc: "ç¢¼é ­", shadow: "å¤§", months: [5,6,7,8,9,10], time: [[0, 24]] },
            { id: "f69", name: "é¬¼é ­åˆ€", price: 6000, loc: "ç¢¼é ­", shadow: "å¤§", months: [5,6,7,8,9,10], time: [[0, 24]] },
            { id: "f70", name: "ç¿»è»Šé­š", price: 4000, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [7,8,9], time: [[4, 21]] },
            { id: "f71", name: "é­Ÿé­š", price: 3000, loc: "å¤§æµ·", shadow: "å¤§", months: [8,9,10,11], time: [[4, 21]] },
            { id: "f72", name: "é‹¸é¯Š", price: 12000, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f73", name: "é›™é«»é¯Š", price: 8000, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f74", name: "é¯Šé­š", price: 15000, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [6,7,8,9], time: [[16, 9]] },
            { id: "f75", name: "é¯¨é¯Š", price: 13000, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [6,7,8,9], time: [[0, 24]] },
            { id: "f76", name: "å¸ç›¤é­š", price: 1500, loc: "å¤§æµ·", shadow: "èƒŒé°­", months: [6,7,8,9], time: [[0, 24]] },
            { id: "f77", name: "ç‡ˆç± é­š", price: 2500, loc: "å¤§æµ·", shadow: "ä¸­åå¤§", months: [1,2,3,11,12], time: [[16, 9]] },
            { id: "f78", name: "çš‡å¸¶é­š", price: 9000, loc: "å¤§æµ·", shadow: "ç‰¹å¤§", months: [1,2,3,4,5,12], time: [[0, 24]] },
            { id: "f79", name: "å¤ªå¹³æ´‹æ¡¶çœ¼é­š", price: 15000, loc: "å¤§æµ·", shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[21, 4]] },
            { id: "f80", name: "çŸ›å°¾é­š", price: 15000, loc: "å¤§æµ·(é›¨å¤©)", shadow: "ç‰¹å¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] }
        ];

        // ğŸ¦‹ æ˜†èŸ² (80éš»å®Œæ•´ç‰ˆ)
        const bugData = [
            { id: "b1", name: "ç™½ç²‰è¶", price: 160, loc: "ç©ºä¸­", months: [1,2,3,4,5,6,9,10,11,12], time: [[4, 19]] },
            { id: "b2", name: "æ–‘ç·£é»ç²‰è¶", price: 160, loc: "ç©ºä¸­", months: [3,4,5,6,9,10], time: [[4, 19]] },
            { id: "b3", name: "é³³è¶", price: 240, loc: "ç©ºä¸­", months: [3,4,5,6,7,8,9], time: [[4, 19]] },
            { id: "b4", name: "çƒé´‰é³³è¶", price: 2500, loc: "ç©ºä¸­", months: [3,4,5,6], time: [[4, 19]] },
            { id: "b5", name: "é’å¸¶é³³è¶", price: 300, loc: "ç©ºä¸­", months: [4,5,6,7,8], time: [[4, 19]] },
            { id: "b6", name: "å¤§ç™½æ–‘è¶", price: 1000, loc: "ç©ºä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[8, 19]] },
            { id: "b7", name: "å¤§ç´«è›ºè¶", price: 3000, loc: "ç©ºä¸­", months: [5,6,7,8], time: [[4, 19]] },
            { id: "b8", name: "å¤§æ¨ºæ–‘è¶", price: 140, loc: "ç©ºä¸­", months: [9,10,11], time: [[4, 17]] },
            { id: "b9", name: "å¤§è—é–ƒè¶", price: 4000, loc: "ç©ºä¸­", months: [1,2,3,6,7,8,9,12], time: [[17, 8]] },
            { id: "b10", name: "å½©è¥–è›ºè¶", price: 3000, loc: "ç©ºä¸­", months: [4,5,6,7,8,9], time: [[8, 17]] },
            { id: "b11", name: "ç´…é ¸é³³è¶", price: 2500, loc: "ç©ºä¸­", months: [1,2,4,5,6,7,8,9,12], time: [[8, 17]] },
            { id: "b12", name: "äºæ­·å±±å¤§é³³è¶", price: 4000, loc: "ç©ºä¸­", months: [5,6,7,8,9], time: [[8, 16]] },
            { id: "b13", name: "é£›è›¾", price: 130, loc: "ç‡ˆå…‰é™„è¿‘", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[19, 4]] },
            { id: "b14", name: "çš‡è›¾", price: 3000, loc: "æ¨¹å¹¹", months: [4,5,6,7,8,9], time: [[19, 4]] },
            { id: "b15", name: "æ—¥è½å¨¥", price: 2500, loc: "ç©ºä¸­", months: [4,5,6,7,8,9], time: [[8, 16]] },
            { id: "b16", name: "ä¸­è¯åŠè§’è—", price: 200, loc: "åœ°é¢", months: [4,5,6,7,8,9,10,11], time: [[8, 19]] },
            { id: "b17", name: "é£›è—", price: 600, loc: "åœ°é¢", months: [8,9,10,11], time: [[8, 19]] },
            { id: "b18", name: "ç¨»è—", price: 400, loc: "åœ°é¢", months: [8,9,10,11], time: [[8, 19]] },
            { id: "b19", name: "èš±èœ¢", price: 160, loc: "åœ°é¢", months: [7,8,9], time: [[8, 17]] },
            { id: "b20", name: "èŸ‹èŸ€", price: 130, loc: "åœ°é¢", months: [9,10,11], time: [[17, 8]] },
            { id: "b21", name: "éˆ´èŸ²", price: 430, loc: "åœ°é¢", months: [9,10], time: [[17, 8]] },
            { id: "b22", name: "è³è‚", price: 430, loc: "èŠ±æœµä¸Š", months: [3,4,5,6,7,8,9,10,11], time: [[8, 17]] },
            { id: "b23", name: "è˜­èŠ±è³è‚", price: 2400, loc: "èŠ±æœµä¸Š", months: [3,4,5,6,7,8,9,10,11], time: [[8, 17]] },
            { id: "b24", name: "èœœèœ‚", price: 200, loc: "èŠ±å¢é™„è¿‘", months: [3,4,5,6,7], time: [[8, 17]] },
            { id: "b25", name: "é»ƒèœ‚", price: 2500, loc: "æ–æ¨¹", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b26", name: "æ²¹èŸ¬", price: 250, loc: "æ¨¹å¹¹", months: [7,8], time: [[8, 17]] },
            { id: "b27", name: "æ–‘é€ç¿…èŸ¬", price: 300, loc: "æ¨¹å¹¹", months: [7,8], time: [[8, 17]] },
            { id: "b28", name: "ç†ŠèŸ¬", price: 500, loc: "æ¨¹å¹¹", months: [7,8], time: [[8, 17]] },
            { id: "b29", name: "å¯’èŸ¬", price: 400, loc: "æ¨¹å¹¹", months: [8,9], time: [[8, 17]] },
            { id: "b30", name: "æš®èŸ¬", price: 550, loc: "æ¨¹å¹¹", months: [7,8], time: [[4, 8], [16, 19]] },
            { id: "b31", name: "èŸ¬è›»", price: 10, loc: "æ¨¹å¹¹", months: [7,8], time: [[0, 24]] },
            { id: "b32", name: "ç´…èœ»èœ“", price: 180, loc: "ç©ºä¸­", months: [9,10], time: [[8, 19]] },
            { id: "b33", name: "ç¶ èƒ¸æ™èœ“", price: 230, loc: "ç©ºä¸­", months: [4,5,6,7,8,9,10], time: [[8, 17]] },
            { id: "b34", name: "ç„¡éœ¸å‹¾èœ“", price: 4500, loc: "ç©ºä¸­", months: [5,6,7,8,9,10], time: [[8, 17]] },
            { id: "b35", name: "è±†å¨˜", price: 500, loc: "ç©ºä¸­", months: [1,2,11,12], time: [[0, 24]] },
            { id: "b36", name: "è¢ç«èŸ²", price: 300, loc: "æ·¡æ°´é™„è¿‘", months: [6], time: [[19, 4]] },
            { id: "b37", name: "è»è›„", price: 500, loc: "åœ°ä¸‹", months: [1,2,3,4,5,11,12], time: [[0, 24]] },
            { id: "b38", name: "æ°´é»½", price: 130, loc: "æ°´é¢", months: [5,6,7,8,9], time: [[8, 19]] },
            { id: "b39", name: "é¾è¨", price: 800, loc: "æ°´é¢", months: [5,6,7,8,9], time: [[8, 19]] },
            { id: "b40", name: "ç”°é±‰", price: 2000, loc: "æ°´é¢", months: [4,5,6,7,8,9], time: [[19, 8]] },
            { id: "b41", name: "æ¤¿è±¡", price: 120, loc: "èŠ±æœµä¸Š", months: [3,4,5,6,7,8,9,10], time: [[0, 24]] },
            { id: "b42", name: "äººé¢æ¤¿è±¡", price: 1000, loc: "èŠ±æœµä¸Š", months: [3,4,5,6,7,8,9,10], time: [[19, 8]] },
            { id: "b43", name: "ç“¢èŸ²", price: 200, loc: "èŠ±æœµä¸Š", months: [3,4,5,6,10], time: [[8, 17]] },
            { id: "b44", name: "è™ç”²èŸ²", price: 1500, loc: "åœ°é¢", months: [2,3,4,5,6,7,8,9,10], time: [[0, 24]] },
            { id: "b45", name: "å‰ä¸èŸ²", price: 2400, loc: "æ¨¹æ¨", months: [4,5,6,7,8], time: [[0, 24]] },
            { id: "b46", name: "æç´èŸ²", price: 450, loc: "æ¨¹æ¨", months: [5,6,9,10,11], time: [[0, 24]] },
            { id: "b47", name: "æ˜Ÿå¤©ç‰›", price: 350, loc: "æ¨¹æ¨", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b48", name: "ç‰ç’ƒæ˜Ÿå¤©ç‰›", price: 3000, loc: "æ¨¹æ¨", months: [5,6,7,8,9], time: [[0, 24]] },
            { id: "b49", name: "å¯¶çŸ³è±¡é¼»èŸ²", price: 800, loc: "æ¨¹å¹¹", months: [7,8], time: [[0, 24]] },
            { id: "b50", name: "ç³é‡‘é¾œ", price: 3000, loc: "é›ªåœ°", months: [1,2,12], time: [[0, 24]] },
            { id: "b51", name: "é›ªéš±é‡‘é¾œ", price: 300, loc: "åœ°é¢", months: [7,8,9], time: [[0, 24]] },
            { id: "b52", name: "å¯¶çŸ³é‡‘é¾œ", price: 10000, loc: "æ¨¹å¹¹", months: [7,8], time: [[23, 8]] },
            { id: "b53", name: "æ—¥éŠ…é‘¼èŠ±é‡‘é¾œ", price: 200, loc: "æ¨¹å¹¹", months: [6,7,8], time: [[0, 24]] },
            { id: "b54", name: "æ­Œåˆ©äºå¤§è§’èŠ±é‡‘é¾œ", price: 8000, loc: "æ¤°å­æ¨¹", months: [6,7,8,9], time: [[17, 8]] },
            { id: "b55", name: "é‹¸é¬å½¢èŸ²", price: 2000, loc: "æ¨¹å¹¹", months: [7,8], time: [[0, 24]] },
            { id: "b56", name: "æ·±å±±é¬å½¢èŸ²", price: 1000, loc: "æ¨¹å¹¹", months: [7,8], time: [[0, 24]] },
            { id: "b57", name: "å¤§é¬å½¢èŸ²", price: 10000, loc: "æ¨¹å¹¹", months: [7,8], time: [[23, 8]] },
            { id: "b58", name: "å½©è™¹é¬å½¢èŸ²", price: 6000, loc: "æ¨¹å¹¹", months: [6,7,8,9], time: [[19, 8]] },
            { id: "b59", name: "ç´°èº«èµ¤é¬å½¢èŸ²", price: 8000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b60", name: "é»ƒé‡‘é¬¼é¬å½¢èŸ²", price: 12000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b61", name: "é•·é ¸é¹¿é‹¸é¬å½¢èŸ²", price: 12000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b62", name: "ç¨è§’ä»™", price: 1350, loc: "æ¨¹å¹¹", months: [7,8], time: [[17, 8]] },
            { id: "b63", name: "é«˜å¡è–©æ–¯å—æ´‹å¤§å…œèŸ²", price: 8000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b64", name: "è±¡å…œèŸ²", price: 8000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b65", name: "é•·æˆŸå¤§å…œèŸ²", price: 12000, loc: "æ¤°å­æ¨¹", months: [7,8], time: [[17, 8]] },
            { id: "b66", name: "ç«¹ç¯€èŸ²", price: 600, loc: "æ¨¹å¹¹", months: [7,8,9,10,11], time: [[4, 8], [17, 19]] },
            { id: "b67", name: "è‘‰ç«¹éš±èŸ²", price: 600, loc: "æ“¬æ…‹æ¨¹è‘‰", months: [7,8,9], time: [[0, 24]] },
            { id: "b68", name: "è“‘è¡£èŸ²", price: 600, loc: "æ–æ¨¹", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b69", name: "èèŸ»", price: 80, loc: "è…çˆ›å¤§é ­èœ", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b70", name: "å¯„å±…èŸ¹", price: 1000, loc: "æ²™ç˜", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[19, 8]] },
            { id: "b71", name: "æµ·èŸ‘è‚", price: 200, loc: "å²©çŸ³", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b72", name: "è’¼è …", price: 60, loc: "åƒåœ¾", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b73", name: "èšŠå­", price: 130, loc: "ç©ºä¸­", months: [6,7,8,9], time: [[17, 4]] },
            { id: "b74", name: "è·³èš¤", price: 70, loc: "å±…æ°‘èº«ä¸Š", months: [4,5,6,7,8,9,10,11], time: [[0, 24]] },
            { id: "b75", name: "è¸ç‰›", price: 250, loc: "é›¨å¤©å²©çŸ³", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "b76", name: "é¼ å©¦", price: 250, loc: "æ•²çŸ³é ­", months: [1,2,3,4,5,6,9,10,11,12], time: [[23, 16]] },
            { id: "b77", name: "èœˆèš£", price: 300, loc: "æ•²çŸ³é ­", months: [1,2,3,4,5,6,9,10,11,12], time: [[16, 23]] },
            { id: "b78", name: "èœ˜è››", price: 600, loc: "æ–æ¨¹", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[19, 8]] },
            { id: "b79", name: "ç‹¼è››", price: 8000, loc: "åœ°é¢", months: [1,2,3,4,11,12], time: [[19, 4]] },
            { id: "b80", name: "è å­", price: 8000, loc: "åœ°é¢", months: [5,6,7,8,9,10], time: [[19, 4]] }
        ];

        // ğŸ¤¿ æµ·æ´‹ç”Ÿç‰© (40éš»å®Œæ•´ç‰ˆ)
        const seaData = [
            { id: "s1", name: "è£™å¸¶èœ", price: 600, shadow: "å¤§", months: [1,2,3,4,5,6,7,10,11,12], time: [[0, 24]] },
            { id: "s2", name: "æµ·è‘¡è„", price: 900, shadow: "ä¸­", months: [6,7,8,9], time: [[0, 24]] },
            { id: "s3", name: "æµ·åƒ", price: 500, shadow: "å¤§", months: [1,2,3,4,11,12], time: [[0, 24]] },
            { id: "s4", name: "æµ·è±¬", price: 10000, shadow: "ä¸­", months: [1,2,11,12], time: [[16, 9]] },
            { id: "s5", name: "æµ·æ˜Ÿ", price: 500, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s6", name: "æµ·è†½", price: 1700, shadow: "ä¸­", months: [5,6,7,8,9], time: [[0, 24]] },
            { id: "s7", name: "çŸ³ç­†æµ·è†½", price: 2000, shadow: "ä¸­", months: [5,6,7,8,9], time: [[16, 9]] },
            { id: "s8", name: "æµ·è‘µ", price: 500, shadow: "å¤§", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s9", name: "æµ·æœˆæ°´æ¯", price: 600, shadow: "ä¸­", months: [7,8,9], time: [[0, 24]] },
            { id: "s10", name: "æµ·è›è“", price: 600, shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s11", name: "ç æ¯è›¤", price: 2800, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s12", name: "è²½è²", price: 1500, shadow: "ä¸­", months: [6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s13", name: "ç‰¡è £", price: 1100, shadow: "ä¸­", months: [1,2,9,10,11,12], time: [[0, 24]] },
            { id: "s14", name: "å¸†ç«‹è²", price: 1200, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s15", name: "å³¨èº", price: 1000, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s16", name: "è§’è ‘èº", price: 1000, shadow: "å°", months: [3,4,5,9,10,11,12], time: [[0, 24]] },
            { id: "s17", name: "é®‘é­š", price: 2000, shadow: "å¤§", months: [1,6,7,8,9,10,11,12], time: [[16, 9]] },
            { id: "s18", name: "å¤§ç¡¨ç£²", price: 15000, shadow: "å¤§", months: [5,6,7,8,9], time: [[0, 24]] },
            { id: "s19", name: "é¸šéµ¡èº", price: 1800, shadow: "ä¸­", months: [3,4,5,6,9,10,11], time: [[16, 9]] },
            { id: "s20", name: "ç« é­š", price: 1200, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s21", name: "æ‰é¢è›¸", price: 6000, shadow: "å°", months: [3,4,5,9,10,11], time: [[0, 24]] },
            { id: "s22", name: "å¸è¡€çƒè³Š", price: 10000, shadow: "å¤§", months: [5,6,7,8], time: [[16, 9]] },
            { id: "s23", name: "è¢ç«é­·", price: 1400, shadow: "å°", months: [3,4,5,6], time: [[21, 4]] },
            { id: "s24", name: "ä¸‰ç–£æ¢­å­èŸ¹", price: 2200, shadow: "ä¸­", months: [6,7,8,9,10,11], time: [[0, 24]] },
            { id: "s25", name: "é¦–é•·é»ƒé“èŸ¹", price: 1900, shadow: "å¤§", months: [1,2,3,4,5,11,12], time: [[0, 24]] },
            { id: "s26", name: "æ¾è‘‰èŸ¹", price: 6000, shadow: "å¤§", months: [1,2,3,4,11,12], time: [[0, 24]] },
            { id: "s27", name: "é±ˆå ´èŸ¹", price: 8000, shadow: "å¤§", months: [1,2,3,11,12], time: [[0, 24]] },
            { id: "s28", name: "è—¤å£º", price: 600, shadow: "å°", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[0, 24]] },
            { id: "s29", name: "é«˜è…³èŸ¹", price: 12000, shadow: "å¤§", months: [3,4], time: [[0, 24]] },
            { id: "s30", name: "æ—¥æœ¬å›Šå°è¦", price: 3000, shadow: "ä¸­", months: [6,7,8,9], time: [[16, 9]] },
            { id: "s31", name: "ç”œè¦", price: 1400, shadow: "å°", months: [1,2,9,10,11,12], time: [[16, 9]] },
            { id: "s32", name: "è¦è›„", price: 2500, shadow: "ä¸­", months: [1,2,3,4,5,6,7,8,9,10,11,12], time: [[16, 9]] },
            { id: "s33", name: "ä¼Šå‹¢é¾è¦", price: 5000, shadow: "ä¸­", months: [10,11,12], time: [[21, 4]] },
            { id: "s34", name: "è¯é¾è¦", price: 4500, shadow: "å¤§", months: [1,4,5,6,12], time: [[0, 24]] },
            { id: "s35", name: "å¤§ç‹å…·è¶³èŸ²", price: 12000, shadow: "å¤§", months: [7,8,9,10], time: [[9, 16], [21, 4]] },
            { id: "s36", name: "é±Ÿ", price: 2500, shadow: "ä¸­", months: [7,8,9], time: [[21, 4]] },
            { id: "s37", name: "æµ·é˜", price: 1500, shadow: "å°", months: [4,5,6,7,8], time: [[0, 24]] },
            { id: "s38", name: "èŠ±åœ’é°»", price: 1100, shadow: "ä¸­", months: [5,6,7,8,9,10], time: [[4, 21]] },
            { id: "s39", name: "æµ·æ‰èŸ²", price: 700, shadow: "å°", months: [8,9], time: [[16, 9]] },
            { id: "s40", name: "å•è€åŒç©´", price: 5000, shadow: "å¤§", months: [1,2,10,11,12], time: [[0, 24]] }
        ];

        // åŒ–çŸ³ (ç„¡æ™‚é–“)
        const fossilData = [
            {id: 'fo1', name: 'æš´é¾çš„é ­', price: 6000, icon: 'ğŸ¦–'},
            {id: 'fo2', name: 'è…•é¾çš„é ­', price: 6000, icon: 'ğŸ¦•'},
            {id: 'fo3', name: 'æš´é¾çš„èº«é«”', price: 5500, icon: 'ğŸ¦–'},
            {id: 'fo4', name: 'ä¸‰è§’é¾çš„é ­', price: 5500, icon: 'ğŸ¦•'},
            {id: 'fo5', name: 'ç•°é½’é¾çš„èº«é«”', price: 5000, icon: 'ğŸ¦•'},
            {id: 'fo6', name: 'åŠé¾çš„é ­', price: 5000, icon: 'ğŸ¦•'},
            {id: 'fo7', name: 'ä¸‰è‘‰èŸ²', price: 1300, icon: 'ğŸš'},
            {id: 'fo8', name: 'ç¥ç€', price: 1200, icon: 'ğŸ’'},
            {id: 'fo9', name: 'èŠçŸ³', price: 1100, icon: 'ğŸš'},
            {id: 'fo10', name: 'æé¾è…³å°', price: 1000, icon: 'ğŸ¾'}
        ];

        // ç´ æ (ç„¡æ™‚é–“)
        const materialData = [
            {id: 'm1', name: 'é‡‘ç¤¦çŸ³', price: 10000, icon: 'ğŸ’'},
            {id: 'm2', name: 'éµç¤¦çŸ³', price: 375, icon: 'ğŸª¨'},
            {id: 'm3', name: 'èœ‚çª©', price: 300, icon: 'ğŸ'},
            {id: 'm4', name: 'ç«¹ç­', price: 250, icon: 'ğŸ'},
            {id: 'm5', name: 'é»åœŸ', price: 100, icon: 'ğŸ§±'},
            {id: 'm6', name: 'çŸ³é ­', price: 100, icon: 'ğŸª¨'},
            {id: 'm7', name: 'ç«¹å­', price: 80, icon: 'ğŸ'},
            {id: 'm8', name: 'æœ¨æ', price: 60, icon: 'ğŸªµ'},
            {id: 'm9', name: 'é›œè‰', price: 10, icon: 'ğŸŒ¿'},
            {id: 'm10', name: 'æ‰‡è²æ®¼', price: 900, icon: 'ğŸš'},
            {id: 'm11', name: 'æµ·èºæ®¼', price: 700, icon: 'ğŸš'},
            {id: 'm12', name: 'çŠç‘š', price: 500, icon: 'ğŸª¸'},
            {id: 'm13', name: 'æ²™éŒ¢', price: 120, icon: 'âšª'}
        ];

        // å®¶å…· (ç„¡æ™‚é–“)
        const furnitureData = [
            {id: 'fu1', name: 'å™´æ³‰', price: 11700, price2x: 23400, icon: 'â›²'},
            {id: 'fu2', name: 'è²æ®¼åºŠé‹ª', price: 10200, price2x: 20400, icon: 'ğŸ›Œ'},
            {id: 'fu3', name: 'é‘„éµæœ¨DIYæ¡Œ', price: 8520, price2x: 17040, icon: 'ğŸ”¨'},
            {id: 'fu4', name: 'éœ²å¤©æ± ', price: 4350, price2x: 8700, icon: 'â™¨ï¸'},
            {id: 'fu5', name: 'è³èŠ±çµ„åˆ', price: 4000, price2x: 8000, icon: 'ğŸ±'},
            {id: 'fu6', name: 'é‘„éµæœ¨çŸ®æ«ƒ', price: 3840, price2x: 7680, icon: 'ğŸ—„ï¸'},
            {id: 'fu7', name: 'æœ¨å‰ä»–', price: 3210, price2x: 6420, icon: 'ğŸ¸'},
            {id: 'fu8', name: 'ç‹—å±‹', price: 2040, price2x: 4080, icon: 'ğŸ '},
            {id: 'fu9', name: 'çŸ³ç¢‘', price: 1800, price2x: 3600, icon: 'ğŸª¦'},
            {id: 'fu10', name: 'å¹³åº•é‹', price: 1500, price2x: 3000, icon: 'ğŸ³'}
        ];

        // --- è³‡æ–™åº«æ•´åˆ ---
        const db = {
            fish: fishData,
            bug: bugData,
            sea: seaData,
            fossil: fossilData,
            material: materialData,
            furniture: furnitureData
        };

        // --- 2. ç‹€æ…‹ç®¡ç† ---
        let state = {
            category: 'fish',
            filterNow: false,
            filterUncaught: false,
            searchText: '',
            caughtList: JSON.parse(localStorage.getItem('acnh_caught_v3')) || [] 
        };

        // --- 3. æ ¸å¿ƒé‚è¼¯ ---

        function saveProgress() {
            localStorage.setItem('acnh_caught_v3', JSON.stringify(state.caughtList));
            updateStats();
        }

        function toggleCatch(id) {
            if (state.caughtList.includes(id)) {
                state.caughtList = state.caughtList.filter(item => item !== id);
            } else {
                state.caughtList.push(id);
            }
            saveProgress();
            renderGrid();
        }

        function updateStats() {
            const total = db[state.category].length;
            const currentCatIds = db[state.category].map(i => i.id);
            const caughtCount = state.caughtList.filter(id => currentCatIds.includes(id)).length;
            const percent = total === 0 ? 0 : (caughtCount / total) * 100;
            
            document.getElementById('progress-bar').style.width = `${percent}%`;
            document.getElementById('stats-display').innerText = 
                `${getCatName(state.category)}æ”¶é›†é€²åº¦ï¼š${caughtCount} / ${total}`;
        }

        function getCatName(cat) {
            const names = {fish:'é­šé¡', bug:'æ˜†èŸ²', sea:'æµ·æ´‹ç”Ÿç‰©', fossil:'åŒ–çŸ³', material:'ç´ æ', furniture:'å®¶å…·'};
            return names[cat] || cat;
        }

       function isAvailable(item) {
            if (!item.months) return true; // ç„¡æ™‚é–“é™åˆ¶ç‰©å“

            const now = new Date();
            const m = now.getMonth() + 1;
            const h = now.getHours();

            // 1. æª¢æŸ¥æœˆä»½
            if (!item.months.includes(m)) return false;
            
            // 2. æª¢æŸ¥æ™‚é–“ (æ”¯æ´å¤šå€‹æ™‚æ®µï¼Œä¾‹å¦‚ [[9,16], [21,4]])
            // åªè¦ç¬¦åˆå…¶ä¸­ä¸€å€‹æ™‚æ®µå°±ç®— Active
            return item.time.some(([start, end]) => {
                if (start === 0 && end === 24) return true;
                if (start < end) {
                    return h >= start && h < end;
                } else {
                    return h >= start || h < end; // è·¨å¤œ
                }
            });
        }

        // --- 4. ä»‹é¢æ“ä½œ ---

        function switchTab(cat) {
            state.category = cat;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // è™•ç†ç¯©é¸æŒ‰éˆ•çš„é¡¯ç¤º (åŒ–çŸ³å®¶å…·ä¸éœ€è¦ "åªçœ‹ç¾åœ¨")
            const hasTime = ['fish', 'bug', 'sea'].includes(cat);
            document.getElementById('btn-now').style.display = hasTime ? 'inline-block' : 'none';
            if (!hasTime) { state.filterNow = false; document.getElementById('btn-now').classList.remove('active'); }

            updateStats();
            renderGrid();
        }

        function toggleNow() {
            state.filterNow = !state.filterNow;
            document.getElementById('btn-now').classList.toggle('active');
            renderGrid();
        }

        function toggleUncaught() {
            state.filterUncaught = !state.filterUncaught;
            document.getElementById('btn-uncaught').classList.toggle('active');
            renderGrid();
        }

        function handleSearch() {
            state.searchText = document.getElementById('search-input').value.toLowerCase();
            renderGrid();
        }

        
        // --- 5. æ¸²æŸ“å¼•æ“ (ä¿®æ­£åœ–ç¤ºé¡¯ç¤ºå•é¡Œ) ---
        function renderGrid() {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';

            const data = db[state.category];
            const isTimeCategory = ['fish', 'bug', 'sea'].includes(state.category);

            data.forEach(item => {
                const isCaught = state.caughtList.includes(item.id);
                const active = isAvailable(item);

                // ç¯©é¸é‚è¼¯
                if (state.searchText && !item.name.includes(state.searchText)) return;
                if (state.filterNow && isTimeCategory && !active) return;
                if (state.filterUncaught && isCaught) return;

                const card = document.createElement('div');
                card.className = `card ${isCaught ? 'caught' : ''}`;
                card.onclick = () => toggleCatch(item.id);

                // åœ–ç¤ºé˜²å‘†
                let displayIcon = item.icon;
                if (!displayIcon) {
                    if (state.category === 'fish') displayIcon = 'ğŸŸ';
                    else if (state.category === 'bug') displayIcon = 'ğŸ¦‹';
                    else if (state.category === 'sea') displayIcon = 'ğŸ¤¿';
                    else if (state.category === 'fossil') displayIcon = 'ğŸ¦•';
                    else if (state.category === 'material') displayIcon = 'ğŸ¥¥';
                    else if (state.category === 'furniture') displayIcon = 'ğŸª‘';
                    else displayIcon = 'â“';
                }

                // ç”¢ç”Ÿè³‡è¨Š
                let badge = '';
                let metaInfo = '';

                if (state.category === 'furniture') {
                    metaInfo = `ğŸ’° å•†åº—: $${item.price}<br><span style="color:#E65100; font-weight:bold;">ğŸ”¥ 2å€: $${item.price2x}</span>`;
                } else if (!isTimeCategory) {
                    metaInfo = `ğŸ’° åƒ¹æ ¼: $${item.price}`;
                } else {
                    // æ ¼å¼åŒ–æ™‚é–“å­—ä¸² (è™•ç†å¤šæ™‚æ®µ)
                    let timeStr = item.time.map(([start, end]) => {
                        if (start === 0 && end === 24) return "å…¨å¤©";
                        return `${start}:00~${end}:00`;
                    }).join(', '); // å¦‚æœæœ‰å¤šå€‹æ™‚æ®µç”¨é€—è™Ÿéš”é–‹

                    badge = active 
                        ? `<span class="time-badge bg-active">ç¾åœ¨å¯æŠ“</span>` 
                        : `<span class="time-badge bg-inactive">ä¼‘æ¯ä¸­</span>`;
                    
                    const loc = item.loc ? `ğŸ“ ${item.loc}` : '';
                    const shadow = item.shadow ? `ğŸ“ ${item.shadow}` : '';
                    metaInfo = `${loc} ${shadow}<br><span class="price-tag">ğŸ’° $${item.price}</span>`;
                    metaInfo += `<br><span style="font-size:0.75rem; color:#888;">ğŸ•’ ${timeStr}</span>`;
                }

                card.innerHTML = `
                    <div class="card-icon">${displayIcon}</div>
                    <div class="card-info">
                        <h3>${item.name}</h3>
                        <div class="meta-tags">${metaInfo}</div>
                        ${badge}
                    </div>
                `;
                container.appendChild(card);
            });

            if(container.innerHTML === '') {
                container.innerHTML = '<div style="width:100%; text-align:center; color:#999; padding:20px;">æ‰¾ä¸åˆ°ç¬¦åˆçš„è³‡æ–™ ğŸ§</div>';
            }
        }
// --- 6. å•Ÿå‹•ç¨‹å¼ (é€™æ˜¯åŸæœ¬å°‘æ‰çš„éƒ¨åˆ†) ---
        window.onload = function() {
            updateStats(); // æ›´æ–°é€²åº¦æ¢
            renderGrid();  // æ¸²æŸ“å¡ç‰‡
        };
    </script>
</body>

</html>

